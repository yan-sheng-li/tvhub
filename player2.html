<!DOCTYPE html>
<html lang="zh-CN">
<head>
  <meta charset="UTF-8">
  <title>ğŸ¬ èŠ‚ç›®å•ç‚¹æ’­ç³»ç»Ÿï¼ˆDPlayerç‰ˆï¼‰</title>
  <script src="https://unpkg.com/vue@3/dist/vue.global.prod.js"></script>
  <script src="https://cdn.jsdelivr.net/npm/dplayer@1.27.1/dist/DPlayer.min.js"></script>
  <link href="https://cdn.jsdelivr.net/npm/bootstrap@5.3.2/dist/css/bootstrap.min.css" rel="stylesheet">
  <style>
    body { background: #f6f7f9; padding: 20px; }
    .day-card { margin-bottom: 20px; border-radius: 10px; }
    .program-item:hover { background: #f1f1f1; cursor: pointer; }
    #dplayer { width: 100%; height: 480px; border-radius: 10px; overflow: hidden; }
  </style>
</head>
<body>
<div id="app" class="container">
  <h2 class="text-center mb-4">ğŸ“º èŠ‚ç›®å•ç‚¹æ’­ç³»ç»Ÿï¼ˆDPlayerç‰ˆï¼‰</h2>

  <!-- æ’­æ”¾å™¨å®¹å™¨ -->
  <div id="dplayer" class="mb-4 shadow-sm"></div>

  <!-- èŠ‚ç›®å• -->
  <div v-for="(day, index) in playlist" :key="index" class="card day-card shadow-sm">
    <div class="card-header bg-primary text-white">{{ day.title }}</div>
    <ul class="list-group list-group-flush">
      <li v-for="(item, i) in day.programs" :key="i"
          class="list-group-item d-flex justify-content-between align-items-center program-item"
          @click="play(item)">
        <span>{{ item.name }}</span>
        <small class="text-muted">{{ item.url }}</small>
      </li>
    </ul>
  </div>
</div>

<script>
const { createApp } = Vue;

createApp({
  data() {
    return {
      rawData: `
ç¬¬1å¤©,#genre#
è½¬åœº1,http://liyansheng.top/hls/t1.mp4?source=1
ä¸Šç”˜å²­_01,http://dow.dowlz19.com/20241014/27929_12f6afa3/ä¸Šç”˜å²­01.mp4
è½¬åœº2,http://liyansheng.top/hls/t1.mp4?source=2
ä¸Šç”˜å²­_02,http://dow.dowlz19.com/20241015/27985_53fa265e/ä¸Šç”˜å²­02.mp4
è½¬åœº3,http://liyansheng.top/hls/t1.mp4?source=3
ä¸Šç”˜å²­_03,http://dow.dowlz19.com/20241015/27984_35395b10/ä¸Šç”˜å²­03.mp4

ç¬¬2å¤©,#genre#
è½¬åœº4,http://liyansheng.top/hls/t1.mp4?source=4
ä¸Šç”˜å²­_04,http://dow.dowlz19.com/20241016/28031_c74ec071/ä¸Šç”˜å²­04.mp4
è½¬åœº5,http://liyansheng.top/hls/t1.mp4?source=5
ä¸Šç”˜å²­_05,http://dow.dowlz19.com/20241016/28030_9f025caa/ä¸Šç”˜å²­05.mp4
è½¬åœº6,http://liyansheng.top/hls/t1.mp4?source=6
ä¸Šç”˜å²­_06,http://dow.dowlz19.com/20241017/28075_da669252/ä¸Šç”˜å²­06.mp4

ç›´æ’­,#genre#
å—å›½éƒ½å¸‚,https://tencentplay.gztv.com/live/nanguodushi.m3u8
æœç‹å‰§åœº,https://hdl-vip-ws.qf.56.com/live/lc_11730.flv
æ–°è§†è§‰,http://120.76.248.139/live/bfgd/4200000249.m3u8
çºªå®ç§‘æ•™,http://120.76.248.139/live/bfgd/4200000113.m3u8
å“ˆå“ˆç‚«åŠ¨,http://120.238.94.10:9901/tsfile/live/1037_1.m3u8
`,
      playlist: [],
      dp: null
    };
  },
  mounted() {
    this.playlist = this.parsePlaylist(this.rawData);
    this.initPlayer();
  },
  methods: {
    parsePlaylist(text) {
      const lines = text.trim().split(/\r?\n/).filter(line => line.trim());
      const days = [];
      let current = null;
      for (let line of lines) {
        if (line.includes('#genre#')) {
          if (current) days.push(current);
          current = { title: line.split(',')[0], programs: [] };
        } else if (line.includes(',')) {
          const [name, url] = line.split(',');
          current?.programs.push({ name: name.trim(), url: url.trim() });
        }
      }
      if (current) days.push(current);
      return days;
    },
    initPlayer() {
      this.dp = new DPlayer({
        container: document.getElementById('dplayer'),
        video: { url: '', type: 'auto' },
        autoplay: false,
        preload: 'none',
      });
    },
    play(item) {
      if (!this.dp) this.initPlayer();
      // åˆ¤æ–­æ ¼å¼ç±»å‹
      let type = 'auto';
      if (item.url.endsWith('.m3u8')) type = 'hls';
      else if (item.url.endsWith('.flv')) type = 'flv';
      else if (item.url.endsWith('.mp4')) type = 'mp4';

      this.dp.switchVideo({
        url: item.url,
        type: type,
        pic: '',
      });
      this.dp.play();
    }
  }
}).mount('#app');
</script>
</body>
</html>
